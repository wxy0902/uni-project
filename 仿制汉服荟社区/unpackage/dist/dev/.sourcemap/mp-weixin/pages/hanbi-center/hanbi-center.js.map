{"version":3,"sources":["uni-app:///main.js","webpack:////Users/wangxinyao/Documents/HBuilderProjects/project/仿制汉服荟社区/pages/hanbi-center/hanbi-center.vue?d662","webpack:////Users/wangxinyao/Documents/HBuilderProjects/project/仿制汉服荟社区/pages/hanbi-center/hanbi-center.vue?7a5a","webpack:////Users/wangxinyao/Documents/HBuilderProjects/project/仿制汉服荟社区/pages/hanbi-center/hanbi-center.vue?6b6f","webpack:////Users/wangxinyao/Documents/HBuilderProjects/project/仿制汉服荟社区/pages/hanbi-center/hanbi-center.vue?19cf","uni-app:///pages/hanbi-center/hanbi-center.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA,wCAAmB;AACnB;AACA,iH;AACAA,UAAU,CAACC,oBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;;;AAG3D;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,WAAW,sQAEN;AACL,GAAG;AACH;AACA,WAAW,4KAEN;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAAA;AAAy1B,CAAgB,0yBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkD72B;;;AAGA;;;AAGA,uE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAKA,EACA,YACA;AACA,sBAFA,gCAEA,CACA,oDACA,CAJA,EAKA;AACA,cANA,wBAMA,CACA,yDACA,CARA,EASA;AACA,aAVA,uBAUA,CACA,+CACA,CAZA,EADA,EAgBA,MAhBA,kBAgBA,OAhBA,EAgBA,mBACA;AACA,0EACA,yFACA,CAFA,EAGA,CArBA,EAuBA,WACA;AACA,cAFA,sBAEA,QAFA,EAEA,mBACA,qCACA,gBADA,EAEA,OAFA,EAGA,kBAHA,EAIA,oBAJA,IAKA,IALA,CAKA,oBACA,wBACA,iEACA,CAFA,MAEA,CACA,mGACA,CACA,yFACA,CAZA,EAYA,KAZA,CAYA,aACA,kBACA,CAdA,EAeA,CAlBA,EAmBA;AACA,eApBA,uBAoBA,GApBA,EAoBA,CACA,wCACA,gDACA,CAvBA,EAwBA;AACA,kBAzBA,4BAyBA,CACA,iBACA,uCADA;AAGA,KA7BA;AA8BA;AACA,cA/BA,sBA+BA,EA/BA,EA+BA,KA/BA,EA+BA;AACA;AACA;AACA,yBADA;AAEA;AACA;AACA;AACA;AACA,0BADA;AAEA,wBAFA;;AAIA;AACA,wBADA;AAEA,8BAFA;AAGA,wBAHA;AAIA,gBAJA,CAIA;AACA;AACA;AACA,6BADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAhBA,EAgBA,KAhBA,CAgBA;AACA;AACA,aAlBA;AAmBA;AACA,SA7BA;;AA+BA,KAhEA,EAvBA,E","file":"pages/hanbi-center/hanbi-center.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/hanbi-center/hanbi-center.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./hanbi-center.vue?vue&type=template&id=292e35c6&\"\nvar renderjs\nimport script from \"./hanbi-center.vue?vue&type=script&lang=js&\"\nexport * from \"./hanbi-center.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/hanbi-center/hanbi-center.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./hanbi-center.vue?vue&type=template&id=292e35c6&\"","var components = {\n  mescrollUni: function() {\n    return import(\n      /* webpackChunkName: \"components/mescroll-uni/mescroll-uni\" */ \"@/components/mescroll-uni/mescroll-uni.vue\"\n    )\n  },\n  iIcon: function() {\n    return import(\n      /* webpackChunkName: \"components/i-icon/i-icon\" */ \"@/components/i-icon/i-icon.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.signinShopListData, function(item, index) {\n    var $orig = _vm.__get_orig(item)\n\n    var m0 = _vm.calDatetime(item.Orders.Datetime)\n    return {\n      $orig: $orig,\n      m0: m0\n    }\n  })\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./hanbi-center.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./hanbi-center.vue?vue&type=script&lang=js&\"","<template>\r\n  <view>\r\n    <!-- 滚动内容区 -->\r\n    <mescroll-uni :down=\"{use:false}\" @up=\"upCallback\">\r\n      <!-- 我的汉币 -->\r\n      <view class=\"plr18r ptb28r f28r flexr-jsb flex-aic bgwhite mb28r\">\r\n        <view class=\"cgray\">\r\n          我的汉币：<text class=\"ctheme\">{{hanbiCount}}</text>\r\n        </view>\r\n        <view class=\"flex flex-aic\" @tap=\"fnSigninRecord\">\r\n          <view class=\"ctheme mr8r\">我的兑换</view>\r\n          <i-icon type=\"you\" size=\"36\" color=\"#FF6699\"></i-icon>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 汉币规则 -->\r\n      <view class=\"plr28r ptb28r bgwhite mb28r\">\r\n        <view class=\"flexr-jsc flex-aic mb28r\">\r\n          <view class=\"line-gl-c222\"></view>\r\n          <view class=\"f28r mlr28r cgray\">汉币规则</view>\r\n          <view class=\"line-gr-c222\"></view>\r\n        </view>\r\n        <block v-for=\"(item,index) in hanbiRule\" :key=\"index\">\r\n          <view class=\"f28r c555\" :class=\"{mb18r: index < hanbiRule.length -1}\">{{item}}</view>\r\n        </block>\r\n      </view>\r\n\r\n      <!-- 汉币商品 -->\r\n      <block v-for=\"(item,index) in signinShopListData\" :key=\"index\">\r\n        <view class=\"bgwhite mb18r\">\r\n          <view class=\"bbs2r ptb18r plr18r flex\">\r\n            <image class=\"hw200r br8r mr18r\" :src=\"item.ImgSrc + '_200x200.jpg'\" mode=\"aspectFill\"></image>\r\n            <view class=\"flex-fitem flexc-jsa\">\r\n              <view class=\"f28r c555\">{{item.Name}}</view>\r\n              <view class=\"f28r ctheme hl80r bbdash2r\"><text class=\"f36r mr8r\">{{item.Price}}</text>汉币</view>\r\n              <view class=\"f24r cgray\">\r\n                <text class=\"ctheme mr8r\">{{item.Orders.User.NickName}}</text> {{calDatetime(item.Orders.Datetime)}}分钟前换取了\r\n              </view>\r\n            </view>\r\n          </view>\r\n          <view class=\"flexr-jfe ptb18r plr18r\">\r\n            <view class=\"f28r bgtheme cwhite br8r plr18r ptb18r\" @tap=\"fnHanbiExc(item.ID,item.Price)\">汉币兑换</view>\r\n          </view>\r\n        </view>\r\n      </block>\r\n    </mescroll-uni>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    fnFormatDate,\r\n  } from \"@/utils/CommonUtil.js\"\r\n  import {\r\n    getSysParamValue\r\n  } from \"@/api/CommonServer.js\"\r\n  import {\r\n    getHanbiShopList,\r\n    addHanbiOrders\r\n  } from \"@/api/HanbiServer.js\"\r\n\r\n  export default {\r\n    computed: {\r\n      // 签到商品列表\r\n      signinShopListData() {\r\n        return this.$store.getters['getSigninShopListData']\r\n      },\r\n      // 我的汉币数\r\n      hanbiCount() {\r\n        return this.$store.getters['user/getUserInfoData'].Hanbi\r\n      },\r\n      // 汉币规则\r\n      hanbiRule() {\r\n        return this.$store.getters['getHanbiRuleData']\r\n      },\r\n    },\r\n\r\n    onLoad(options) {\r\n      // 获取汉币规则\r\n      getSysParamValue('hanbirule').then(res => {\r\n        this.$store.commit('setHanbiRuleData', res.data.Data.Value.match(/[^><]+(?=<\\/p>)/img))\r\n      })\r\n    },\r\n\r\n    methods: {\r\n      /// 上拉加载的回调: mescroll携带page的参数, 其中num:当前页 从1开始, size:每页数据条数,默认10\r\n      upCallback(mescroll) {\r\n        getHanbiShopList({\r\n          haveorders: true,\r\n          role: 5,\r\n          page: mescroll.num,\r\n          count: mescroll.size\r\n        }).then(shopRes => {\r\n          if (mescroll.num == 1) {\r\n            this.$store.commit('setSigninShopListData', shopRes.data.Data)\r\n          } else {\r\n            this.$store.commit('setSigninShopListData', this.signinShopListData.concat(shopRes.data.Data))\r\n          }\r\n          mescroll.endSuccess(shopRes.data.Data.length, shopRes.data.Data.length >= mescroll.size);\r\n        }).catch(() => {\r\n          mescroll.endErr();\r\n        })\r\n      },\r\n      /// 计算格式友好时间 几天前\r\n      calDatetime(str) {\r\n        let timestamp = new Date(str).getTime();\r\n        return fnFormatDate(timestamp);\r\n      },\r\n      /// 跳转汉币兑换记录\r\n      fnSigninRecord() {\r\n        uni.navigateTo({\r\n          url: '/pages/hanbi-record/hanbi-record'\r\n        })\r\n      },\r\n      /// 汉币兑换\r\n      fnHanbiExc(id, price) {\r\n        if (this.orderState) return\r\n        uni.showModal({\r\n          content: '确认兑换吗？',\r\n          success: res => {\r\n            if (res.confirm) {\r\n              this.orderState = true\r\n              uni.showLoading({\r\n                title: '兑换中',\r\n                mask: true\r\n              })\r\n              addHanbiOrders({\r\n                shopid: id,\r\n                useraddressid: 0,\r\n                remark: '',\r\n              }).then(res => {\r\n                uni.hideLoading()\r\n                uni.showToast({\r\n                  title: '兑换成功'\r\n                })\r\n                this.orderState = false;\r\n                // 登录用户汉币数减少\r\n                let tempUser = this.$store.getters['user/getUserInfoData']\r\n                tempUser.Hanbi = Number(tempUser.Hanbi) - Number(price)\r\n                this.$store.commit('user/setUserInfoData', tempUser)\r\n                // 重新初始签到日历\r\n                this.$refs.signinCalendar.init()\r\n              }).catch(() => {\r\n                this.orderState = false;\r\n              })\r\n            }\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style></style>\n"],"sourceRoot":""}